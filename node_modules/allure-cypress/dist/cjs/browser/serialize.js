"use strict";

Object.defineProperty(exports, "__esModule", {
  value: true
});
exports.default = void 0;
var _sdk = require("allure-js-commons/sdk");
var _state = require("./state.js");
var _default = value => isDomObject(value) ? stringifyAsDom(value) : (0, _sdk.serialize)(value, getSerializeOptions());
exports.default = _default;
var getSerializeOptions = () => {
  var {
    stepsFromCommands: {
      maxArgumentDepth: maxDepth,
      maxArgumentLength: maxLength
    }
  } = (0, _state.getConfig)();
  return {
    maxDepth,
    maxLength,
    nonNullReplacerWithDomSupport
  };
};
var isDomObject = value => typeof value === "object" && value !== null && Cypress.dom.isDom(value);

// @ts-ignore
var stringifyAsDom = value => Cypress.dom.stringify(value, "long");
var nonNullReplacerWithDomSupport = (_, value) => {
  if (typeof value === "object") {
    // Exclude null properties to make the result more compact.
    if (value === null) {
      return undefined;
    }
    if (Cypress.dom.isDom(value)) {
      // Window, document, and DOM element properties are serialized with Cypress.dom.stringify.
      return stringifyAsDom(value);
    }
  }

  // Use the implementation from allure-js-commons/sdk in all other cases.
  return value;
};
module.exports = exports.default;
//# sourceMappingURL=serialize.js.map